---
layout: post
tagline:  ""
title: "Plustek OpticSlim 2400 + Windows 8.1"
date:   2015-01-10 02:00:00
category: posts
tags : [WIN,DEV]
wordpress_id : 1004
---

На руках имелся сканер Plustek OpticSlim 2400 и была необходимость подружить его с Windows 8.1. Официально данное устройство в Windows 8.1 неподдерживается: производитель забил болт и разводит на новое железо. Решил побороть несправедливость. 

### Morbus 

Жил-был вышеуказанный сканер, приобретён ещё в эпоху Windows XP, но работу свою делал исправно. Самая большая проблема, которая доставляла неудобства -- ПО идущее в комплекте, Plustek явно незапаривался. 
Однако, время бежало, и к выходу Windows 8 оказалось, что использовать сканер уже невозможно. Драйвера просто не вставали, никак.

![Doom upon us!]({{ site.url }}/images/plustek_win8_1.png) 

Сканер построен на основе SoC Grandtech GT-6816 и у него есть братья-близнецы, которые отличаются разве что наклейкой на корпусе и идущим ПО. И -- ну и самое главное -- под Windows 8.1 работают без проблем (производители оказались не такими жмотами).
Таковым братишкой-молодцом является, к примеру, [Visioneer OneTouch 7400](http://support.visioneer.com/products/7400/downloads.asp).
Естественно, поставить драйвера от OneTouch 7300 не получится, У устройств различаются VID и PID: 

+ Plustek OpticSlim 2400 имеет VID 07B3 PID 0454
+ Visioneer OneTouch 7300 имеет VID 04A7 PID 04A0

Понятно, что если произвести замену соответсвующих записей в идущих файлах драйвера, сканер должен заработать.

Для начала скачаем драйвер сканера Visioneer OneTouch 7400: http://support.visioneer.com/downloads/drivers/7400/7400.4591208.EN.msi

Установим его, благо сканер для этого не нужен. Дистрибутив драйвера можно будет найти в папке %PROGRAMFILES(x86)%\Visioneer\OneTouch 4.0\Visioneer 7400\Drivers\

В дистрибутиве драйвера Plustek OpticSlim 2400 информация о VID/PID устройства идёт в двух файлах:

+ OT_7400.inf
+ ScnDrvU.drv

Соответственно, заменив подстроку "Vid_07B3&PID_0454" на "Vid_04A7&PID_04A0" в данных файлах мы получим драйвер который подойдёт для нашего устройства.

Останется принудительно установить драйвера из указанного каталога.

Ах, да -- чуть не забыл. Windows 8 требует совпадение хэша для файлов драйверов при их устновке, для нас это не пойдёт, по этому перед установкой драйверов нужно перезапустить Win8 в спец.режиме: "Отключить обязательную проверку подписи драйверов".

В итоге сканер определяется и работает

![New days dawn]({{ site.url }}/images/plustek_win8_2.jpg) 

### NotaBene

В качестве лирического отсупления, хочу воздать хвалебную оду Открытому программногому обеспечению. И как ни странно, это на прямую связано с проблемой запуска сканера под новой Редмонской ОС.
Под Linux у меня такой проблемы в принципе не возникло, т.к. SANE (софт для Сканирования там) с давних времён поддерживает работу со сканерами на SoC GrandTech и будет поддерживать столько сколько такие сканеры вообще в ходу. 
По факту, в СПО время поддержки железа, если оно уже поддерживается, ограничено только его моральным устареванием, а не прихотью производителя.

Как это не странно, именно на страницах проекта SANE http://www.meier-geinitz.de/sane/gt68xx-backend/ я нашел возожное и дествительное решение. Найдя свой сканер в списке поддерживаемого SAME оборудования, я откопал его братьев, 
которые были куда сговорчивее и терпимее к Win8.

### Panacea

Для облегчения установки драйверов есть "особенный" дистрибутив с пододящими для Plustek VID и PID. Опять же, его установку нужно производить в режиме без проверки подписи драйверов. Пользуйтесь с умом:

Download: [Visioner 7200 tweaked driver](http://www.filedropper.com/74004591208en)
